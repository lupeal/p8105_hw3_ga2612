---
title: "p8105_hw3_ga2612"
author: "Lupe Antonio"
date: "10/26/2023"
output: 
  github_document:
    toc: TRUE
---

```{r setup, include=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

# Problem 1

```{r}
#loading dataset
library(p8105.datasets)
data("instacart")

instacart <- instacart %>% as_tibble()
```

The instacart dataset has `r nrow(instacart)` observations and `r ncol(instacart)` variables/columns. Each row in this dataset represents a single product ordered through instacart. Variables of this dataset include order, product, and user IDs. Additionally, there are variables corresponding to the order in which product was added to cart, the time of order, days since prior order. There are also variables that describe the product, including product name (i.e. Yogurt, Milk, Water), the aisle (i.e. yogurt, fresh vegetables) and department (i.e. dairy eggs, produce) where it is located and the corresponding aisle and department IDs. 


```{r}
instacart %>%
  count(aisle) %>%
  arrange(desc(n))
```

There are a total of `r instacart %>% pull(aisle) %>% unique() %>% sum()` with fresh vegetables and fresh fruits are ordered most from. Above is a chart summarizing all aisles with the number of products ordered per aisle. 


Below is a plot that shows the number of items ordered per aisle, for aisles with more than 10000 items ordered. 

```{r}
instacart %>%
  count(aisle) %>%
  filter(n > 10000) %>%
  mutate(aisle = fct_reorder(aisle, n)) %>%
  ggplot(aes(x = aisle, y = n)) +
  geom_point() +
  ggtitle('Number of items ordered per aisle') +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


The table below shows the three most popular items in aisles "baking ingredients", "dog food care", and "packaged vegetables fruits". We can also see the number of times each product was ordered.

```{r, message=FALSE}
instacart %>%  
  filter(aisle == "baking ingredients" | aisle == "dog food care" | aisle == "packaged vegetables fruits") %>%
  group_by(aisle) %>%
  count(product_name) %>%
  #min_rank gives rank to each tie (btwn each filtering condition)
  #& we're going based on the highest n in each
  mutate(rank = min_rank(desc(n))) %>%
  filter(rank < 4) %>%
  arrange(desc(n)) %>%
  knitr::kable()
```


Below is a table that displays the average hour of the day at which Pink Lady Apples and Coffee Ice Cream are ordered on each day of the week. 

```{r, message=FALSE}
instacart %>%
  filter(product_name == "Pink Lady Apples" | product_name == "Coffee Ice Cream") %>%
  group_by(product_name, order_dow) %>%
  summarize(avg_hour_of_day = mean(order_hour_of_day)) %>%
  pivot_wider(names_from = order_dow,
              values_from = avg_hour_of_day) %>%
  knitr::kable(digits = 2)
```








```{r}
library(p8105.datasets)
data("brfss_smart2010")
```

